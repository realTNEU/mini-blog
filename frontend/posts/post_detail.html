{% extends 'base.html' %}
{% load custom_filters %}

{% block title %}{{ post.title }} - MiniBlog{% endblock %}

{% block content %}
<div class="post-detail-wrapper">
    <!-- Back Button -->
    <div class="post-back-button" data-aos="fade-right">
        <a href="{% url 'posts:list_posts' %}" class="back-link">
            <i class="fas fa-arrow-left"></i><span>Back to All Posts</span>
        </a>
    </div>

    <!-- Article Container -->
    <article class="post-article glass-effect" data-aos="fade-up">
        <!-- Cover Image -->
        <div class="post-cover">
            {% if post.image %}
                <img src="{{ post.image.url }}" alt="{{ post.title }}" class="post-cover-image">
                <div class="post-cover-overlay"></div>
            {% else %}
                <div class="post-cover-placeholder">
                    <i class="fas fa-feather"></i>
                </div>
            {% endif %}
        </div>
        
        <!-- Content -->
        <div class="post-body">
            <!-- Title -->
            <h1 class="post-title">
                {{ post.title }}
            </h1>
            
            <!-- Meta Information -->
            <div class="post-meta">
                <!-- Author -->
                <div class="post-author">
                    <div class="post-author-avatar">
                        {{ post.author.username|first|upper }}
                    </div>
                    <div class="post-author-info">
                        <p class="post-author-name">{{ post.author.username }}</p>
                        <p class="post-author-role">Author</p>
                    </div>
                </div>
                
                <!-- Dates -->
                <div class="post-dates">
                    <div class="post-date">
                        <p class="post-date-label">Published</p>
                        <time datetime="{{ post.created_at|date:'c' }}" class="post-date-value">
                            {{ post.created_at|date:"F d, Y" }}
                        </time>
                    </div>
                    {% if post.updated_at != post.created_at %}
                        <div class="post-date">
                            <p class="post-date-label">Updated</p>
                            <time datetime="{{ post.updated_at|date:'c' }}" class="post-date-value">
                                {{ post.updated_at|date:"F d, Y" }}
                            </time>
                        </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Article Content -->
            <div class="post-content">
                {{ post.content|linebreaksbr }}
            </div>
            
            <!-- Reading Stats -->
            <div class="post-stats">
                <div class="post-stats-items">
                    <span class="post-stat-item">
                        <i class="fas fa-clock"></i>
                        <span>~{{ post.content|wordcount }} words</span>
                    </span>
                    <span class="post-stat-item">
                        <i class="fas fa-bars"></i>
                        <span>~{{ post.content|length|divideby:200|add:1 }} min read</span>
                    </span>
                </div>
            </div>
        </div>
        
        <!-- Footer Actions -->
        <div class="post-footer">
            <a href="{% url 'posts:list_posts' %}" class="btn-secondary-custom">
                <i class="fas fa-list"></i><span>View All Posts</span>
            </a>
            {% if user == post.author %}
                <button class="btn-primary-custom" onclick="alert('Edit feature coming soon!')">
                    <i class="fas fa-edit"></i><span>Edit Post</span>
                </button>
            {% endif %}
        </div>
    </article>
    
    <!-- Related Posts Section -->
    <div class="post-related-section">
        <h2 class="post-related-title" data-aos="fade-down">
            More from <span class="gradient-text">{{ post.author.username }}</span>
        </h2>
        
        <div class="post-related-grid">
            {% for p in post.author.posts.all|slice:":3" %}
                {% if p.id != post.id %}
                    <a href="{% url 'posts:post_detail' p.pk %}" class="post-related-card glass-effect card-hover" data-aos="fade-up">
                        <div class="post-related-image">
                            {% if p.image %}
                                <img src="{{ p.image.url }}" alt="{{ p.title }}" class="post-related-img">
                            {% else %}
                                <div class="post-related-placeholder">
                                    <i class="fas fa-feather"></i>
                                </div>
                            {% endif %}
                        </div>
                        <div class="post-related-body">
                            <h3 class="post-related-title-text">
                                {{ p.title }}
                            </h3>
                            <p class="post-related-date">{{ p.created_at|date:"M d, Y" }}</p>
                        </div>
                    </a>
                {% endif %}
            {% empty %}
                <p class="post-related-empty">No other posts from this author yet</p>
            {% endfor %}
        </div>
    </div>
</div>

{% endblock %}
